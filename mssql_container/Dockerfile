# MICROSOFT SQL SERVER DATABASE DOCKER IMAGE
FROM mcr.microsoft.com/mssql/server:2022-CU4-ubuntu-20.04
# DEFINED LENGUAGE OS
ENV LANG en_US.UTF-8
ENV LANGUAGE en_US:en
ENV SCRIPT_DIRECTORY /app/scripts
ENV SHELL_DIRECTORY  /app/shell
# WAIT TIME MSSQL FOR EXECUTE SCRIPTS
ENV WAIT_TIME_MSSQL 35s
# MSSQL DEFINITION
ENV ACCEPT_EULA Y
# DEFAULT USER -> SA 
# PASSWORD FOR USER SA IN MSSQL_SA_PASSWORD ENV
ENV MSSQL_SA_PASSWORD S4PasSW0rD
# CHANGE USER COMMAND EXECUTE
USER root
# CREATE SCRIPT FOLDERS
RUN mkdir -p $SCRIPT_DIRECTORY
# CREATE SHELL FOLDERS
RUN mkdir -p $SHELL_DIRECTORY
# COPY SCRIPT SQL FILES
COPY ./scripts/ $SCRIPT_DIRECTORY
# COPY SHELL SCRIPT INIT AND EXECUTE SCRIPT SQL
COPY ./shell/ $SHELL_DIRECTORY
# MODIFIED PERMISSION RECURSIVE METHODS IN FOLDERS
RUN chmod 777 -R $SCRIPT_DIRECTORY
RUN chmod 777 -R $SHELL_DIRECTORY
# OVERRIDE INIT SCRIPT ENTRYPOINT
CMD sh -c "$SHELL_DIRECTORY/entrypoint.sh"